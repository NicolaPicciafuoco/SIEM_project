# =============================================================================
# --- Sezione Regole Snort: Attacchi da Rete Guest ($GUEST_NET) verso $SERVER_NET
# =============================================================================

#  Rilevamento Scansioni Generiche
# Intercetta traffico di scansione su porte non permesse (Nmap su porte diverse da 80/443/21) e tutto il traffico UDP/ICMP.

# POLICY VIOLATION/SCAN: Tentativo TCP su porte non standard (non-80/443/21) verso Server Net
alert tcp $GUEST_NET any -> $SERVER_NET ![80,443,21] (msg:"SCAN DETECT: Guest Network attempting non-HTTP/HTTPS/FTP TCP scan to Server Network"; sid:2000100; rev:1; priority:2;)

# POLICY VIOLATION/SCAN: Tentativo UDP verso Server Net
alert udp $GUEST_NET any -> $SERVER_NET any (msg:"SCAN DETECT: Guest Network attempting UDP scan to Server Network"; sid:2000101; rev:1; priority:2;)

# POLICY VIOLATION/SCAN: Tentativo ICMP (Ping/Scan) verso Server Net
alert icmp $GUEST_NET any -> $SERVER_NET any (msg:"SCAN DETECT: Guest Network attempting ICMP scan/ping to Server Network"; sid:2000102; rev:1; priority:4;)

