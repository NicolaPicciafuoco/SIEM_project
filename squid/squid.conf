# squid/squid.conf

# 1) Porte in modalità trasparente
http_port 3128 intercept
ftp_port  21   intercept

# 2) SSL‐bump per HTTPS (se non ti serve un MITM vero, puoi limitarti a CONNECT)
# Abilita il CONNECT sui soli SSL_ports
acl SSL_ports port 443
acl Safe_ports port 80     # http
acl Safe_ports port 21     # ftp
acl Safe_ports port 443    # https
acl CONNECT method CONNECT

# Permetti le connessioni HTTPS in modalità CONNECT
http_access allow CONNECT SSL_ports

# 3) ACL “localnet” e permessi di default
acl localnet src 10.10.0.0/16
http_access allow localnet
http_access deny all

# 4) Cache / log / umask come prima
cache_mem 256 MB
cache_dir aufs /var/spool/squid 10000 16 256
max_filedescriptors 8192
access_log /var/log/squid/access.log squid
cache_log  /var/log/squid/cache.log squid
umask 022
